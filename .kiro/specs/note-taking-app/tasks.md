# 实施计划

- [x] 1. 初始化项目结构和配置



  - 创建前端项目（React + Vite + TypeScript）
  - 创建后端项目（Node.js + Express + TypeScript）
  - 配置TailwindCSS和基础样式
  - 设置ESLint和Prettier
  - 配置环境变量文件



  - _需求: 6.1, 6.2_

- [ ] 2. 设置数据库和ORM
  - 安装和配置Prisma



  - 定义User和Note数据模型
  - 创建数据库迁移文件
  - 生成Prisma Client
  - _需求: 1.4, 3.5, 5.3_



- [x] 3. 实现后端认证系统


  - [x] 3.1 创建用户注册API

    - 实现邮箱格式验证（支持QQ、163、Google、Outlook）
    - 实现密码加密（bcrypt）
    - 生成邮箱验证token
    - 创建用户记录到数据库
    - _需求: 1.1, 1.2, 1.3_
  - [x] 3.2 实现邮件发送服务

    - 配置Nodemailer
    - 创建邮箱验证邮件模板
    - 实现发送验证邮件功能
    - _需求: 1.3_

  - [ ] 3.3 创建邮箱验证API
    - 验证token有效性
    - 更新用户验证状态

    - _需求: 1.4_
  - [ ] 3.4 创建用户登录API
    - 验证邮箱和密码
    - 检查邮箱验证状态


    - 生成JWT token
    - _需求: 2.2, 2.3, 2.4, 2.5_
  - [x] 3.5 实现JWT认证中间件








    - 验证token有效性
    - 提取用户信息
    - 处理认证错误
    - _需求: 2.5, 5.2_

  - [ ] 3.6 创建用户登出和获取当前用户API
    - 实现登出逻辑
    - 实现获取当前用户信息

    - _需求: 8.2, 8.3_

- [x] 4. 实现后端笔记管理系统

  - [ ] 4.1 创建笔记CRUD API
    - 实现创建笔记接口（POST /api/notes）





    - 实现获取笔记列表接口（GET /api/notes）
    - 实现获取单个笔记接口（GET /api/notes/:id）
    - 实现更新笔记接口（PUT /api/notes/:id）
    - 实现删除笔记接口（DELETE /api/notes/:id）


    - _需求: 3.1, 3.4, 4.1, 4.4, 7.3_
  - [ ] 4.2 实现用户数据隔离
    - 在所有笔记查询中添加userId过滤
    - 验证用户只能操作自己的笔记
    - _需求: 5.1, 5.2, 5.3, 7.5_


  - [ ] 4.3 实现笔记搜索功能
    - 实现按标题和内容搜索
    - 实现不区分大小写搜索


    - _需求: 4.5_
  - [x] 4.4 实现笔记排序和预览





    - 按最后修改时间倒序排列
    - 生成笔记内容预览（前100字符）
    - _需求: 4.2, 4.3_



- [ ] 5. 实现前端认证页面
  - [x] 5.1 创建注册页面

    - 创建注册表单组件（邮箱、密码、确认密码）
    - 实现客户端表单验证
    - 实现注册API调用

    - 显示成功/错误提示





    - _需求: 1.1, 1.2, 1.5_
  - [ ] 5.2 创建登录页面
    - 创建登录表单组件（邮箱、密码）


    - 实现客户端表单验证
    - 实现登录API调用
    - 存储JWT token到localStorage
    - 处理登录错误（密码错误、未验证邮箱）

    - _需求: 2.1, 2.2, 2.3, 2.4_
  - [ ] 5.3 实现邮箱验证页面
    - 创建验证结果显示页面
    - 处理验证token

    - 显示验证成功/失败消息
    - _需求: 1.4_
  - [ ] 5.4 实现认证状态管理
    - 创建useAuth自定义Hook

    - 实现登录状态检查
    - 实现自动登出（token过期）
    - _需求: 2.5, 8.2, 8.4_

- [ ] 6. 实现前端笔记列表页面
  - [ ] 6.1 创建笔记列表组件
    - 实现笔记卡片组件（显示标题、预览、时间）
    - 实现笔记列表布局
    - 使用React Query获取笔记数据
    - _需求: 4.1, 4.2_
  - [ ] 6.2 实现搜索功能
    - 创建搜索栏组件
    - 实现实时搜索
    - 显示搜索结果
    - _需求: 4.5_
  - [ ] 6.3 实现新建笔记按钮
    - 创建"新建笔记"按钮
    - 实现跳转到编辑器页面
    - _需求: 3.1_
  - [ ] 6.4 实现笔记点击跳转
    - 实现点击笔记卡片跳转到详情页
    - _需求: 4.4_

- [ ] 7. 实现前端笔记编辑器
  - [ ] 7.1 集成TipTap富文本编辑器
    - 安装TipTap及相关扩展
    - 配置编辑器（标题、粗体、斜体、列表、代码等）
    - 创建编辑器组件
    - _需求: 3.2_
  - [ ] 7.2 创建编辑器工具栏
    - 实现格式化按钮（H1-H6、粗体、斜体、下划线等）
    - 实现列表按钮（有序、无序）
    - 实现代码块、引用、链接、图片按钮
    - 添加图标和悬停效果
    - _需求: 3.2, 6.3, 6.6_
  - [ ] 7.3 实现笔记保存功能
    - 创建保存按钮
    - 实现手动保存API调用
    - 显示保存成功提示
    - _需求: 3.4_
  - [ ] 7.4 实现自动保存功能
    - 创建useAutoSave自定义Hook
    - 实现30秒防抖自动保存
    - 显示自动保存状态指示器
    - _需求: 3.3_
  - [ ] 7.5 实现笔记删除功能
    - 创建删除按钮
    - 实现删除确认对话框
    - 调用删除API
    - 删除成功后返回列表页
    - _需求: 7.1, 7.2, 7.3, 7.4_

- [ ] 8. 实现应用布局和导航
  - [ ] 8.1 创建主布局组件
    - 实现顶部导航栏
    - 实现侧边栏（可选）
    - 实现响应式布局
    - _需求: 6.1_
  - [ ] 8.2 实现导航栏功能
    - 显示应用Logo和标题
    - 显示当前用户邮箱
    - 实现"退出登录"按钮
    - _需求: 8.1, 8.2_
  - [ ] 8.3 实现路由保护
    - 创建ProtectedRoute组件
    - 未登录用户重定向到登录页
    - 已登录用户访问登录/注册页重定向到主页
    - _需求: 5.4, 8.4_

- [ ] 9. 实现UI样式和动画
  - [ ] 9.1 设计配色方案和主题
    - 配置TailwindCSS主题颜色
    - 定义主色调、辅助色、背景色
    - _需求: 6.2_
  - [ ] 9.2 实现通用组件样式
    - 设计按钮样式（主按钮、次按钮、危险按钮）
    - 设计输入框样式
    - 设计卡片样式
    - 设计模态框样式
    - _需求: 6.2, 6.3_
  - [ ] 9.3 添加交互动画
    - 实现按钮悬停效果
    - 实现页面切换过渡
    - 实现模态框动画
    - 实现列表项动画
    - _需求: 6.3, 6.4_
  - [ ] 9.4 优化响应式设计
    - 实现移动端适配
    - 实现平板端适配
    - 测试不同屏幕尺寸
    - _需求: 6.1_

- [ ] 10. 实现错误处理和用户反馈
  - [ ] 10.1 创建错误处理中间件
    - 实现后端统一错误处理
    - 定义错误代码和消息
    - _需求: 1.5, 2.3, 2.4_
  - [ ] 10.2 实现前端错误提示
    - 集成Toast通知库
    - 实现API错误处理
    - 显示用户友好的错误消息
    - _需求: 1.5, 2.3, 2.4_
  - [ ] 10.3 实现加载状态
    - 添加加载指示器
    - 实现骨架屏（笔记列表）
    - 禁用提交按钮防止重复提交
    - _需求: 6.2_

- [ ] 11. 性能优化
  - [ ] 11.1 实现前端优化
    - 配置React.lazy()代码分割
    - 实现React Query缓存策略
    - 优化图片加载
    - _需求: 6.1_
  - [ ] 11.2 实现后端优化
    - 添加数据库索引（userId、updatedAt）
    - 优化数据库查询（使用select限制字段）
    - 配置数据库连接池
    - _需求: 4.3_

- [ ]* 12. 编写测试
  - [ ]* 12.1 编写后端API测试
    - 编写认证API集成测试
    - 编写笔记API集成测试
    - 测试权限控制
    - _需求: 所有需求_
  - [ ]* 12.2 编写前端组件测试
    - 测试认证表单组件
    - 测试笔记列表组件
    - 测试编辑器组件
    - _需求: 所有需求_
  - [ ]* 12.3 编写E2E测试
    - 测试用户注册和登录流程
    - 测试笔记创建、编辑、删除流程
    - 测试搜索功能
    - _需求: 所有需求_

- [ ] 13. 部署准备
  - 创建生产环境配置
  - 配置环境变量
  - 编写部署文档
  - 设置数据库迁移脚本
  - _需求: 所有需求_
